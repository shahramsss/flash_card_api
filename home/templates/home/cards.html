{% extends 'base.html' %}
{% block style %}
  body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: #f4f4f9; margin: 0; } .card { width: 300px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); text-align: center; } .buttons { margin-top: 20px; display: flex; justify-content: space-between; } button { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; color: white; } .show-answer { background-color: #3498db; } .correct { background-color: #2ecc71; } .wrong { background-color: #e74c3c; }
{% endblock %}

{% block title %}
  My Words
{% endblock %}
{% block content %}
  {% comment %} <div class="container mt-5">
    <form id="answerForm" method="post" action="#">
      {% csrf_token %}
      <div class="row gy-4">
        {% for card in cards %}
          <div class="col-12">
            <div class="card shadow mx-auto" style="max-width: 18rem; border-radius: 10px;">
              <div class="card-body">
                <h5 class="card-title">{{ card.word }}</h5>

                <!-- دکمه نمایش پاسخ -->
                <button type="button" class="btn btn-secondary w-100 mb-3 show-answer-btn" data-card-id="{{ card.id }}">Show Answer</button>

                <!-- معنی کلمه (پنهان) -->
                <p class="card-text text-muted mt-2 meaning" id="meaning-{{ card.id }}" style="display: none;">{{ card.meaning }}</p>

                <!-- دکمه‌های انتخاب جواب (پنهان) -->
                <div class="d-flex justify-content-between mt-3 answer-buttons" id="buttons-{{ card.id }}" style="display: none;">
                  <button type="button" class="btn btn-outline-success w-45 answer-btn" data-card-id="{{ card.id }}" data-answer="yes">Correct</button>
                  <button type="button" class="btn btn-outline-danger w-45 answer-btn" data-card-id="{{ card.id }}" data-answer="no">Incorrect</button>
                </div>

                <!-- فیلد مخفی برای ارسال جواب -->
                <input type="hidden" name="{{ card.id }}" id="{{ card.id }}" required />
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- دکمه ارسال فرم -->
      <div class="text-center mt-4">
        <button type="submit" class="btn btn-primary w-50">Submit Answers</button>
      </div>
    </form>
  </div>

  <script>
    // مدیریت نمایش جواب و دکمه‌ها
    document.querySelectorAll('.show-answer-btn').forEach((button) => {
      button.addEventListener('click', function () {
        const cardId = this.getAttribute('data-card-id')
        const meaningElement = document.getElementById(`meaning-${cardId}`)
        const buttonsElement = document.getElementById(`buttons-${cardId}`)
    
        // نمایش معنی و دکمه‌های جواب
        meaningElement.style.display = 'block'
        buttonsElement.style.display = 'flex'
    
        // غیرفعال کردن دکمه نمایش جواب
        this.style.display = 'none'
      })
    })
    
    // مدیریت انتخاب دکمه‌های پاسخ
    document.querySelectorAll('.answer-btn').forEach((button) => {
      button.addEventListener('click', function () {
        const cardId = this.getAttribute('data-card-id')
        const answer = this.getAttribute('data-answer')
    
        // به‌روزرسانی فیلد مخفی با مقدار انتخاب شده
        document.getElementById(`${cardId}`).value = answer
    
        // تغییر استایل دکمه‌ها برای نشان دادن انتخاب
        const siblingButtons = this.parentElement.querySelectorAll('button')
        siblingButtons.forEach((btn) => {
          btn.classList.remove('active', 'btn-success', 'btn-danger', 'btn-outline-success', 'btn-outline-danger')
        })
    
        if (answer === 'yes') {
          this.classList.add('active', 'btn-success')
          this.classList.remove('btn-outline-success')
        } else {
          this.classList.add('active', 'btn-danger')
          this.classList.remove('btn-outline-danger')
        }
      })
    })
    
    // بررسی کامل بودن فرم قبل از ارسال
    document.getElementById('answerForm').addEventListener('submit', function (event) {
      const unanswered = Array.from(document.querySelectorAll("input[type='hidden']")).filter((input) => input.value === '')
    
      if (unanswered.length > 0) {
        event.preventDefault()
        alert('Please select an answer for all words before submitting.')
      }
    })
  </script> {% endcomment %}
  <!-- کارت‌ها -->
  <ul class="list-group">
    {% for card in cards %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        {{ card.word }}
        <a href="{% url 'home:cardsdetails' card.id %}" class="btn btn-sm btn-primary">View</a>
      </li>
    {% endfor %}
  </ul>

  <!-- نمایش پیام در صورت خالی بودن -->
  {% if not cards %}
    <div class="alert alert-info mt-4" role="alert">No flashcards available to display.</div>
  {% endif %}
{% endblock %}
